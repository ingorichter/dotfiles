# Platform Switch
# the install location of brew on Intel and M1 is different
# Intel= /usr/local/bin/brew
# M1= /opt/homebrew/bin/brew

case "$(uname -m)" in
        "x86_64")
                HOMEBREW=/usr/local/bin/brew
        ;;
        "arm64")
                HOMEBREW=/opt/homebrew/bin/brew
        ;;
        *)
                echo "Unsupported architecture"
        ;;
esac

export HOMEBREW_CELLAR=$(${HOMEBREW} --cellar)
export PATH=$(${HOMEBREW} --prefix)/bin:${PATH}

# Defaults
DEV_ROOT=${HOME}/develop

# Setup dev environment
GOPATH=${DEV_ROOT}/go-workspace
GOBIN=$(export GOPATH; go env GOPATH)/bin

# This is not working anymore!?
# specify JAVA_HOME. Since Java 17 is available, I'm going with it
# JAVA_HOME=$(/usr/libexec/java_home -v 17)

# Modify the $PATH
PATH=${PATH}:${GOBIN}

# load machine specific configuration
MACHINE_CONFIG_FILE="${HOME}/Dropbox/Dotfiles/$(hostname -s)"
if [ -e "${MACHINE_CONFIG_FILE}" ]; then
  source "${MACHINE_CONFIG_FILE}"
fi

# Alias definition
for alias in $(find ~/.alias.d/ -type f -not -name .DS_Store)
do
    source "$alias"
done

export PATH JAVA_HOME GOPATH

# Ingo
# setup rbenv
eval "$(rbenv init -)"

# setup pyenv
eval "$(pyenv init --path)"

if which pyenv-virtualenv-init > /dev/null; then eval "$(pyenv virtualenv-init -)"; fi

export PATH="${PATH}:${HOME}/.fastlane/bin:${HOME}/.cargo/bin"
